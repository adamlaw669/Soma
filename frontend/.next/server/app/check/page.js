(()=>{var e={};e.id=397,e.ids=[397],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3877:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var r=s(65239),a=s(48088),i=s(88170),n=s.n(i),o=s(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c={children:["",{children:["check",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,39074)),"/workspace/frontend/app/check/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"/workspace/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,56032)),"/workspace/frontend/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/workspace/frontend/app/check/page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/check/page",pathname:"/check",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8168:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var r=s(60687),a=s(43210),i=s(16189),n=s(17993),o=s(41778),l=s(68631),c=s(24934),d=s(55192),u=s(13964),p=s(11860),m=s(62688);let h=(0,m.A)("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);function x({question:e,onAnswer:t,className:s}){let[i,n]=(0,a.useState)(0),[o,m]=(0,a.useState)(!1);return(0,r.jsxs)("div",{className:s,children:[(0,r.jsx)(l.P.div,{drag:"x",dragConstraints:{left:0,right:0},dragElastic:.3,dragTransition:{bounceStiffness:300,bounceDamping:20},onDrag:(e,t)=>{m(!0),n(t.offset.x)},onDragEnd:(e,s)=>{m(!1),s.offset.x>80?t(!0):s.offset.x<-80&&t(!1),n(0)},whileDrag:{scale:1.02,rotate:.1*i,boxShadow:"0 10px 30px oklch(0.55 0.15 162 / 0.2)"},className:"relative cursor-grab active:cursor-grabbing",initial:{opacity:0,y:50,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,x:i>0?300:-300,scale:.8},transition:{type:"spring",stiffness:300,damping:30},children:(0,r.jsxs)(d.Zp,{className:"w-full max-w-md mx-auto border-border/50 bg-card/80 backdrop-blur-sm",children:[o?i>40?(0,r.jsx)(l.P.div,{className:"absolute inset-0 flex items-center justify-center bg-primary/20 rounded-lg backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},children:(0,r.jsxs)(l.P.div,{className:"flex items-center space-x-2 text-primary",initial:{scale:.8},animate:{scale:1},children:[(0,r.jsx)(u.A,{className:"h-8 w-8"}),(0,r.jsx)("span",{className:"text-lg font-semibold",children:"Yes"})]})}):i<-40?(0,r.jsx)(l.P.div,{className:"absolute inset-0 flex items-center justify-center bg-destructive/20 rounded-lg backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},children:(0,r.jsxs)(l.P.div,{className:"flex items-center space-x-2 text-destructive",initial:{scale:.8},animate:{scale:1},children:[(0,r.jsx)(p.A,{className:"h-8 w-8"}),(0,r.jsx)("span",{className:"text-lg font-semibold",children:"No"})]})}):null:null,(0,r.jsxs)(d.aR,{className:"text-center",children:[(0,r.jsx)(d.ZB,{className:"text-lg text-card-foreground",children:e.label}),e.helpText&&(0,r.jsx)(d.BT,{className:"text-sm text-muted-foreground",children:e.helpText})]}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsx)(l.P.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,r.jsxs)(c.$,{onClick:()=>t(!1),className:"h-12 text-base w-full border-secondary text-secondary hover:bg-secondary/10",variant:"outline",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"No"]})}),(0,r.jsx)(l.P.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,r.jsxs)(c.$,{onClick:()=>t(!0),className:"h-12 text-base w-full glow-emerald",variant:"default",children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Yes"]})})]}),(0,r.jsx)(l.P.div,{whileHover:{scale:1.02},whileTap:{scale:.98},children:(0,r.jsxs)(c.$,{onClick:()=>t(null),variant:"ghost",className:"w-full text-muted-foreground hover:text-foreground",children:[(0,r.jsx)(h,{className:"mr-2 h-4 w-4"}),"I don't know / Skip"]})})]})]})}),(0,r.jsx)(l.P.div,{className:"mt-6 text-center text-sm text-muted-foreground",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3}})]})}var f=s(86287);function y({current:e,total:t,className:s}){let a=Math.round(e/t*100);return(0,r.jsxs)("div",{className:s,children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-2",children:[(0,r.jsx)("span",{children:"Progress"}),(0,r.jsxs)("span",{children:[a,"%"]})]}),(0,r.jsx)(f.k,{value:a,className:"h-2"}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-muted-foreground mt-1",children:[(0,r.jsxs)("span",{children:[e," of ",t," questions"]}),(0,r.jsxs)("span",{children:[t-e," remaining"]})]})]})}var g=s(68988),b=s(39390);let v=(0,m.A)("Thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]]);function j({onTemperatureChange:e,onContinue:t,initialTemperature:s}){let[i,n]=(0,a.useState)(s?.toString()||""),[o,l]=(0,a.useState)(""),u=t=>{if(n(t),l(""),""===t){e(void 0);return}let s=Number.parseFloat(t);if(isNaN(s)){l("Please enter a valid number");return}if(s<34||s>43){l("Temperature should be between 34\xb0C and 43\xb0C");return}e(s)},p=()=>{(!i||!o)&&t()};return(0,r.jsxs)(d.Zp,{className:"w-full max-w-md mx-auto",children:[(0,r.jsxs)(d.aR,{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-lg bg-primary/10 mb-4",children:(0,r.jsx)(v,{className:"h-6 w-6 text-primary"})}),(0,r.jsx)(d.ZB,{children:"Temperature Check"}),(0,r.jsx)(d.BT,{children:"Since you have a fever, please enter your current body temperature if known"})]}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(b.J,{htmlFor:"temperature",children:"Temperature (\xb0C)"}),(0,r.jsx)(g.p,{id:"temperature",type:"number",placeholder:"37.0",value:i,onChange:e=>u(e.target.value),min:"34",max:"43",step:"0.1"}),o&&(0,r.jsx)("p",{className:"text-sm text-destructive",children:o}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Normal body temperature is around 37\xb0C (98.6\xb0F)"})]}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(c.$,{variant:"outline",onClick:()=>p(),className:"flex-1",children:"Skip"}),(0,r.jsx)(c.$,{onClick:p,disabled:!!o,className:"flex-1",children:"Continue"})]})]})]})}let w=(0,m.A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var N=s(96241);function k({className:e,size:t="md"}){return(0,r.jsx)(w,{className:(0,N.cn)("animate-spin text-primary",{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[t],e)})}var _=s(24785);let T=[{id:"fever",label:"Do you have a fever?",helpText:"Body temperature above normal (usually 37\xb0C/98.6\xb0F)",type:"boolean"},{id:"headache",label:"Do you have a headache?",helpText:"Pain or discomfort in your head or upper neck",type:"boolean"},{id:"chills",label:"Are you experiencing chills or shivering?",helpText:"Feeling cold with uncontrollable shaking",type:"boolean"},{id:"body_pain",label:"Do you have body aches or joint pain?",helpText:"General muscle soreness or joint discomfort",type:"boolean"},{id:"nausea",label:"Are you feeling nauseous or have you vomited?",helpText:"Feeling sick to your stomach or actual vomiting",type:"boolean"},{id:"diarrhea",label:"Do you have diarrhea?",helpText:"Loose, watery bowel movements",type:"boolean"},{id:"cough",label:"Do you have a cough?",helpText:"Persistent coughing, dry or with phlegm",type:"boolean"},{id:"sore_throat",label:"Do you have a sore throat?",helpText:"Pain or irritation in your throat",type:"boolean"},{id:"fatigue",label:"Are you experiencing unusual fatigue or weakness?",helpText:"Feeling more tired than usual or lacking energy",type:"boolean"},{id:"abdominal_pain",label:"Do you have abdominal or stomach pain?",helpText:"Pain or discomfort in your belly area",type:"boolean"},{id:"rash",label:"Do you have any skin rash or changes?",helpText:"New spots, bumps, or changes in your skin",type:"boolean"},{id:"duration_gt_3d",label:"Have your symptoms lasted more than 3 days?",helpText:"Duration of your current symptoms",type:"boolean"}],$=e=>e>=T.length?null:T[e];var C=s(59556),P=s(70334),S=s(13943);function A(){let e=(0,i.useRouter)(),{session:t,initSession:s,updateSymptom:l,updateVitals:u,nextQuestion:p,resetSession:m}=(0,_.S)(),[h,f]=(0,a.useState)(!1),[g,b]=(0,a.useState)(0),[v,w]=(0,a.useState)(!0);if(v||!t)return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(n.NavBar,{}),(0,r.jsx)("main",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)(k,{size:"lg"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Initializing symptom check..."})]})}),(0,r.jsx)(o.w,{})]});let N=$(t.currentQuestionIndex),A=g>=8||t.isComplete,D=()=>{(0,C.$s)("flow_completed",{session_id:t.sessionId,questions_answered:g,total_questions:T.length}),e.push("/result")};return h?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(n.NavBar,{}),(0,r.jsx)("main",{className:"flex-1 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,r.jsx)(y,{current:g,total:T.length,className:"mb-8"}),(0,r.jsx)(j,{onTemperatureChange:e=>{u({temperature_c:e})},onContinue:()=>{f(!1),p()},initialTemperature:t.vitals.temperature_c})]})}),(0,r.jsx)(o.w,{})]}):!N||t.currentQuestionIndex>=T.length?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(n.NavBar,{}),(0,r.jsx)("main",{className:"flex-1 flex items-center justify-center p-4",children:(0,r.jsxs)(d.Zp,{className:"w-full max-w-md mx-auto",children:[(0,r.jsxs)(d.aR,{className:"text-center",children:[(0,r.jsx)(d.ZB,{children:"Symptom Check Complete"}),(0,r.jsxs)(d.BT,{children:["You've answered ",g," questions. Ready to see your results?"]})]}),(0,r.jsxs)(d.Wu,{className:"space-y-4",children:[(0,r.jsxs)(c.$,{onClick:D,className:"w-full",size:"lg",children:[(0,r.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"See Results"]}),(0,r.jsxs)(c.$,{onClick:()=>{m(),s(),f(!1),(0,C.$s)("symptom_check_restarted")},variant:"outline",className:"w-full bg-transparent",children:[(0,r.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Start Over"]})]})]})}),(0,r.jsx)(o.w,{})]}):(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(n.NavBar,{}),(0,r.jsx)("main",{className:"flex-1 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,r.jsx)(y,{current:g,total:T.length,className:"mb-8"}),(0,r.jsx)(x,{question:N,onAnswer:e=>{if(N){if(null!==e&&(l(N.id,e),(0,C.$s)("question_answered",{question:N.id,answer:e,session_id:t.sessionId}),"fever"===N.id&&!0===e)){f(!0);return}p()}},className:"mb-8"}),A&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsxs)(c.$,{onClick:D,size:"lg",className:"bg-accent hover:bg-accent/90",children:[(0,r.jsx)(P.A,{className:"mr-2 h-4 w-4"}),"See Results (",g," questions answered)"]})})]})}),(0,r.jsx)(o.w,{})]})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13964:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},24785:(e,t,s)=>{"use strict";s.d(t,{S:()=>n});var r=s(26787),a=s(59350);let i=()=>"session_"+Math.random().toString(36).substr(2,9)+"_"+Date.now(),n=(0,r.v)()((0,a.Zr)((e,t)=>({session:null,apiBaseUrl:null,history:[],initSession:()=>{e({session:{sessionId:i(),symptoms:{},vitals:{},demographics:{},currentQuestionIndex:0,isComplete:!1}})},updateSymptom:(s,r)=>{let{session:a}=t();a&&e({session:{...a,symptoms:{...a.symptoms,[s]:r}}})},updateVitals:s=>{let{session:r}=t();r&&e({session:{...r,vitals:{...r.vitals,...s}}})},updateDemographics:s=>{let{session:r}=t();r&&e({session:{...r,demographics:{...r.demographics,...s}}})},nextQuestion:()=>{let{session:s}=t();if(!s)return;let r=s.currentQuestionIndex+1;e({session:{...s,currentQuestionIndex:r,isComplete:r>=8}})},resetSession:()=>{e({session:null})},setApiBaseUrl:t=>{e({apiBaseUrl:t})},addDiagnosisToHistory:s=>{let r=t().session;if(!r)return null;let a=s.distribution.slice(0,3),i={id:`${r.sessionId}-${Date.now()}`,created_at:new Date().toISOString(),session_id:r.sessionId,top_label:s.top_prediction.label,top_probability:s.top_prediction.probability,top3:a,symptoms:r.symptoms,full_distribution:s.distribution,triage:s.triage,status:"pending"};return e(e=>({history:[...e.history,i]})),i}}),{name:"soma-session",partialize:e=>({session:e.session,apiBaseUrl:e.apiBaseUrl,history:e.history})}))},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39074:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/workspace/frontend/app/check/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/workspace/frontend/app/check/page.tsx","default")},44577:(e,t,s)=>{Promise.resolve().then(s.bind(s,39074))},57729:(e,t,s)=>{Promise.resolve().then(s.bind(s,8168))},59556:(e,t,s)=>{"use strict";s.d(t,{$s:()=>n,Ee:()=>h,G1:()=>p,IJ:()=>x,Lk:()=>m,Q2:()=>y,Q4:()=>c,Vp:()=>u,ZJ:()=>i,a:()=>f,ly:()=>d,oh:()=>l,qF:()=>a});let r=()=>"https://soma-6c1p.onrender.com",a=async e=>{let t=r(),s=t?`${t}/predict`:"/api/predict",a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok)throw Error(`Prediction failed: ${a.statusText}`);return a.json()},i=async e=>{let t=r(),s=new URLSearchParams({labels:e.join(",")}),a=t?`${t}/diseases?${s}`:`/api/diseases?${s}`,i=await fetch(a);if(!i.ok)throw Error(`Disease info failed: ${i.statusText}`);return i.json()},n=(e,t)=>{},o=e=>{let t=r();return t?`${t}${e}`:`/api${e}`};async function l(e){if(r())try{let t=await fetch(o("/reports/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok)return t.json()}catch{}let t=await fetch("/api/reports/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(`Report generation failed: ${t.statusText}`);return t.json()}async function c(e){let t=o(`/reports${e?`?session_id=${encodeURIComponent(e)}`:""}`),s=await fetch(t);if(s.ok)return s.json();let r=await fetch(`/api/reports${e?`?session_id=${encodeURIComponent(e)}`:""}`);if(!r.ok)throw Error(`Get reports failed: ${r.statusText}`);return r.json()}async function d(e){let t=await fetch(o(`/reports/${e}`));if(t.ok)return t.json();let s=await fetch(`/api/reports/${e}`);if(!s.ok)throw Error(`Get report failed: ${s.statusText}`);return s.json()}function u(e){try{return}catch{}}function p(){try{return[]}catch{return[]}}function m(e){return p().find(t=>t.id===e)}function h(){return p().slice(-5).reverse().slice(0,3).map(e=>({id:e.id,summary:e.llm_summary??"",predicted_label:e.predicted.label,generated_at:e.generated_at}))}async function x(){let e=r(),t=e?`${e}/doctor/diagnoses`:"/api/doctor/diagnoses",s=await fetch(t,{headers:{"x-role":"doctor"}});if(!s.ok)throw Error(`Get diagnoses failed: ${s.statusText}`);return s.json()}async function f(e){let t=r(),s=t?`${t}/doctor/diagnosis/${e}`:`/api/doctor/diagnosis/${e}`,a=await fetch(s,{headers:{"x-role":"doctor"}});if(!a.ok)throw Error(`Get diagnosis failed: ${a.statusText}`);return a.json()}async function y(e){let t=r(),s=t?`${t}/doctor/review/${e.diagnosis_id}`:`/api/doctor/review/${e.diagnosis_id}`,a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json","x-role":"doctor"},body:JSON.stringify({status:e.action,feedback:e.notes})});if(!a.ok)throw Error(`Review failed: ${a.statusText}`);return a.json()}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},68988:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var r=s(60687);s(43210);var a=s(96241);function i({className:e,type:t,...s}){return(0,r.jsx)("input",{type:t,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...s})}},70334:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(62688).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},86287:(e,t,s)=>{"use strict";s.d(t,{k:()=>n});var r=s(60687);s(43210);var a=s(25177),i=s(96241);function n({className:e,value:t,...s}){return(0,r.jsx)(a.bL,{"data-slot":"progress",className:(0,i.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",e),...s,children:(0,r.jsx)(a.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})})}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[447,566,536,631,296,849,378],()=>s(3877));module.exports=r})();